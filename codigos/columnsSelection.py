import numpy as np
import pandas as pd
import json
import jsonlines

dataset = pd.read_json('datasets/db_eleicoes_brasil2020.json', lines=True, nrows=1000)

# selection of supposed relevant columns
datasetColumns = dataset.columns.values
columnsList = ['created_at',
               'id_str',
               'text',  # dictionary - not null
               'source',
               'truncated',
               'in_reply_to_user_id_str',
               'in_reply_to_screen_name',
               'user',  # dictionary - not null
               'geo',
               'coordinates',
               'extended_tweet', # dictionary - optional
               'quote_count',
               'reply_count',
               'retweet_count',
               'favorite_count',
               'entities',  # dictionary - 
               'favorited',
               'retweeted',
               'possibly_sensitive',
               'filter_level',
               'lang',
               'timestamp_ms',
               'retweeted_status',  # dictionary
               'quoted_status',  # dictionary
               'extended_entities']


# process columns where its data is a dictionary
dataset.loc[3, ['text', 'user', 'extended_tweet', 'entities', 'retweeted_status', 'quoted_status']]

dataset.loc[3, 'quoted_status']

dictionaryAttributes = ['text', 'user', 'extended_tweet',
                        'entities', 'retweeted_status', 'quoted_status']


def ExtractDictionary(attributeName):
    dictRecord = dataset[attributeName]
for attribute in dictionaryAttributes:
    dataset
    print(attribute)


dataset.loc[1, 'user']
dataset.iloc[0, :]
len(txt)



usrDict = dataset.loc[0, 'extended_tweet']

json.loads(usrDict)
with jsonlines.open('test.jsonl', mode='a') as file:
    file.write(usrDict)

with open('testSave2Json.json', 'a+') as file:
    json.dump(usrDict, file, indent=3, sort_keys=True)

for datasetIndex in range(0, len(dataset)):
    print(dataset.iloc[datasetIndex, :])
     = dataset.iloc[datasetIndex, ]
    break


for u, t in zip(dataset['user'], dataset['extendend_tweet']):
    usrList.append({'Name': u['name'], 'Text': t['full_text']})


# select rows which columns are not null
dataset['id'][pd.isnull(dataset['extended_tweet'])]

# return unique values from a dataframe column
pd.unique(dataset.loc[:, 'coordinates'])




# DATASET - eleicoes prefeitura rj 2020
# Problema - analise de sentimentos sobre os tweets dos perfis dos candidatos, e dos
# Questoes
